# BixPythonProject0

## Bioinformatics Python Project

This project was conducted after the completion of my Introduction to Bioinformatics using Python module during my MSc in Applied Bioinformatics course at Cranfield University, UK.

## Summary Report of the Project
The project was designed to test my ability to use the argparse module to manipulate some text files from the command terminal.
The summarise_picard_metrics.py script was designed to work on plain Python, not Jupyter notebook or anything else. This program takes as input input folder (containing multiple subfolders), analyses the text files in each subfolder by counting the number of files in each subfolder, makes summary text files and plots and then hands back the results to a user-defined output folder. For information on how to run this program, please see the user manual of this program attached to the repo. Also attached is the technical report on the project explaining the technical details of the python code. Example output files and plots are referenced in the report.

## Technical Report
The summarise_picard_metrics.py script was designed to work on plain Python, not Jupyter notebook or anything else, hence the “.y”. This program takes as input multiple subfolders containing text files, provided as a single input folder, analyses the text files in each subfolder by counting the number of files in each subfolder, makes summary text files and plots and then hands back the results to a user-defined output folder. For information on how to run this program, please see the user manual of this program attached to this report. 

## Design/Structure of the Program 
The program has the following structure and design:
Required libraries – the required libraries/modules for this program were imported here. Libraries such as the os module (for interacting with files), matplotlib (for making plots), pandas (for creating data frames), argparse (for parsing command line arguments) and numpy (for generating numpy arrays) were imported and utilized in different functions of the script.

## Functions
The following functions were used in the program:

1)	count_source_text_files() – this function counts the number of source files in the input folder. It takes as an argument, the folder path and returns the number of source text files in each subfolder in the path. This function was defined to count the number of samples in hs_metrics, insert_sizes and dedup_metrics folders provided for this task.

2)	remove_headers() – this function removes headers starting with ‘#’ and ‘##’ that are not required for the analysis of the text files. It takes as an argument line and reads through the lines of each sample text file of the subfolders.

3)	combine_and_save_summary_text() – this is the function that reads the content of the subfolders provided in the input folder, combines the text files and saves the summary text files to the output folder. It takes two arguments: the subfolder path and the output folder. The function also prints to the user in the command line the path to the folder where the summary files were saved. The function was also designed to exclude headers not starting with the “#” or “##” and maintain a single header in the summary text file. These summary text files were later used for plotting the sample summaries.

4)	combine_and_save_hist_text() – this function extracts histogram data from the source files, combines them and saves to the output folder. It takes a subfolder path and an output folder as arguments. It also prints to the user the path to the output folder where the combined text files were saved. These files are generated only for duplicate and insert size metrices and were used to plot the histograms.
  
5)	hs_summary_plot() – this function plots the hybridization selection metrics summary file. It takes as arguments the summary file, the output folder (where the result is saved) and the variables to be plotted. It also informed the user where this plot is saved.


 ![image](https://github.com/user-attachments/assets/7065210e-591a-4ff8-ac6b-2f494d278d8f)

Figure 1: Simple line summary plot of some selected hybridization metrics variables generated by hs_summary_plot()

Interpretation – the plot shows a correlation between the mean bait coverage and mean target coverage across all 12 samples of the hybridization selection metrics.

6)	dedup_summary_plot() – this function plot the mark duplicates metrics summary file. It takes as arguments the summary text file, the output folder and the selected variables to be plotted. The generated example plot by this function is shown below.


 ![image](https://github.com/user-attachments/assets/ceb63e0d-945f-4f5c-b453-43968a9820bc)

Figure2: A summary barplot of unpaired reads examined and unpaired reads duplicates of duplicate metrics generated by the dedup_summary_plot().

7)	insert_summary_plot() – this function plot the insert size metrics as the two functions above. An example plot generated by this function is shown below.

 ![image](https://github.com/user-attachments/assets/81b44350-0512-4fae-a325-be15b34a4948)

Figure3: A summary barplot for median insert sizes and median absolute deviation variables of insert sizes metrics generated by the insert_summary_plot() function.

Interpretation – the median insert sizes and median absolute deviation of the insert size metrics show a similar pattern. 

8)	dedup_summary_hist() – the function plots a histogram of the extracted histogram values. It takes the summary histogram text file and the output folder as arguments. An example of a plot generated by this function is shown below.

 ![image](https://github.com/user-attachments/assets/f79be732-1b80-4b99-8c18-39a02f82c326)

Figure 4: A summary histogram for duplicate metrics generated by the dedup_summary_hist() function.

Interpretation – the histogram of the duplicate metrics does not show a normal distribution across the samples.

9)	insert_summary_hist() – this plot a histogram of the summary histogram file and prints to the output folder. Below is an example of a histogram generated by this function.

 ![image](https://github.com/user-attachments/assets/62550929-17c0-4bff-bd66-b493dada1a89)

Figure 5: A summary histogram for insert size metrics generated by the insert_summary_hist() function.

Interpretation – the insert size histogram indicates that the smaller insert sizes are abundantly observed compared to the larger inserts.

10)	main() – this serves as the entry point to the program. It contains all the argparse arguments for interacting with the user via the command prompt. The parser arguments provided by this are as follows:

a)	Required arguments – the required arguments here are input and output folders. These arguments are compulsory must be provided by the user when running the program. The input folder is the folder containing the subfolders of the sample text files, while the output folder is where the result of the analyses will be printed.

b)	Optional arguments – five optional arguments can be provided in addition to the required arguments and include the following:

•	args.counts: provided using “-c” or “—counts”, when provided, the program calls the count_source_text_files() and counts the number of source text files for each of the hs_metrics, insert_sizes() and dedup_metrics() folders, prints to the user in the command prompt and exit the program. The screenshot below was generated using the “-c” argument.

 
![image](https://github.com/user-attachments/assets/4dbd2653-3d83-4a22-94be-dc98fa16c718)

•	args.hybridization: provided using “-hyb” or “—hybridization”, when provided, the argument calls count_source_text_files(), combine_and_save_summary_text() and hs_summary_plot() functions which provide the number of source text files, summary text file and plot for the hybridization selection metrics. See picture below.

 
![image](https://github.com/user-attachments/assets/ad2eb18e-8fca-4fe4-9a88-e6f36ec6f411)

•	args.inserts: can be provided using “-ins” or “—inserts”, and will call the count_source_text_files(), combine_and_save_summary_text(), combine_and_save_hist_text(), insert_summary_plot() and insert_summary_hist() and these functions will print the number of source text files, print to the output folder the summary text/hist files and plot and histogram respectively for the insert sizes metrics as shown below.

 
![image](https://github.com/user-attachments/assets/1ae3c2e6-52b8-483e-a3da-a099dad56386)

•	args.duplicates: using “-dup” or “duplicates”, calls the count_source_text_files(), combine_and_save_summary_text(), combine_and_save_hist_text(), dedup_summary_plot() and dedup_summary_hist() functions. They print the number of source text files, print to the output folder the summary text/hist files and plot and histogram respectively for the duplicate metrics as shown below.

 
![image](https://github.com/user-attachments/assets/fa3f5e06-a314-4889-93a4-399066eb59a4)

•	args.all: provided using “-a” or “—all” and calls all the functions and executes all the above tasks as shown below.

 
![image](https://github.com/user-attachments/assets/56830110-f08a-4809-a2e0-eb885f26b4ca)

All the example plots, summary text files, and histograms obtained while testing the program were provided in a folder called ‘Output folder’, as well as the input folder containing the test data. 

